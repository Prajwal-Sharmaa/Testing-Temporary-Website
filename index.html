<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechieNova - Go from Idea to Done, Faster. | Top Freelance Talent & Teams</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Google Font: Inter & Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <style>
        /* Use Inter font as the default */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        
        h1, h2, h3, .brand-font {
            font-family: 'Poppins', sans-serif;
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Professional gradient backgrounds */
        .gradient-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .gradient-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        /* Card hover effect */
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            transform: translateY(-4px);
        }

        /* Simple loading spinner */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #667eea;
            animation: spin 1s ease infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
        
        /* Fade in animation */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        
        /* Stagger animation for multiple elements */
        .stagger-1 { animation-delay: 0.1s; }
        .stagger-2 { animation-delay: 0.2s; }
        .stagger-3 { animation-delay: 0.3s; }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>
<body class="antialiased">

    <!-- 
      Main Application Shell
      This contains the header and the dynamic content area.
    -->
    <div id="app-shell" class="min-h-screen">

        <!-- Navigation Bar -->
        <nav id="navbar" class="bg-white/98 backdrop-blur-md shadow-md sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-20">
                    <!-- Logo -->
                    <div class="flex-shrink-0 flex items-center">
                        <a href="#" onclick="app.navigateTo('home')" class="text-3xl font-extrabold brand-font">
                            <span class="bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">TechieNova</span>
                        </a>
                    </div>

                    <!-- Desktop Nav -->
                    <div class="hidden md:flex md:items-center md:space-x-8">
                        <a href="#" onclick="app.navigateTo('findTalent')" class="font-medium text-slate-600 hover:text-indigo-600 transition-colors duration-200">Find Talent</a>
                        <a href="#" onclick="app.navigateTo('findWork')" class="font-medium text-slate-600 hover:text-indigo-600 transition-colors duration-200">Find Work</a>
                        <a href="#" onclick="app.navigateTo('home', '#how-it-works')" class="font-medium text-slate-600 hover:text-indigo-600 transition-colors duration-200">How It Works</a>
                    </div>

                    <!-- Auth Buttons (Desktop) -->
                    <div id="nav-auth-desktop" class="hidden md:flex items-center space-x-4">
                        <a href="#" onclick="app.navigateTo('auth', 'login')" class="font-medium text-slate-600 hover:text-indigo-600 transition-colors duration-200">Log In</a>
                        <a href="#" onclick="app.navigateTo('auth', 'signup')" class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-2.5 rounded-lg font-semibold shadow-lg hover:shadow-xl hover:from-indigo-700 hover:to-purple-700 transition-all duration-300">
                            Sign Up
                        </a>
                    </div>

                    <!-- Dashboard Button (Desktop, shown when logged in) -->
                    <div id="nav-dashboard-desktop" class="hidden md:flex items-center space-x-4">
                        <span id="nav-welcome" class="font-medium text-slate-600"></span>
                        <a href="#" onclick="app.navigateTo('dashboard')" class="font-medium text-slate-600 hover:text-indigo-600 transition-colors duration-200">Dashboard</a>
                        <a href="#" onclick="app.logout()" class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-2.5 rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all duration-300">
                            Log Out
                        </a>
                    </div>

                    <!-- Mobile Menu Button -->
                    <div class="md:hidden flex items-center">
                        <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-slate-600 hover:text-slate-900 hover:bg-slate-100 focus:outline-none">
                            <span class="sr-only">Open main menu</span>
                            <!-- Heroicon: menu -->
                            <svg id="menu-open-icon" class="h-6 w-6 block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
                            </svg>
                            <!-- Heroicon: x -->
                            <svg id="menu-close-icon" class="h-6 w-6 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Mobile Menu -->
            <div id="mobile-menu" class="hidden md:hidden">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="#" onclick="app.navigateTo('findTalent')" class="block px-3 py-2 rounded-md text-base font-medium text-slate-700 hover:bg-slate-100 hover:text-indigo-600">Find Talent</a>
                    <a href="#" onclick="app.navigateTo('findWork')" class="block px-3 py-2 rounded-md text-base font-medium text-slate-700 hover:bg-slate-100 hover:text-indigo-600">Find Work</a>
                    <a href="#" onclick="app.navigateTo('home', '#how-it-works')" class="block px-3 py-2 rounded-md text-base font-medium text-slate-700 hover:bg-slate-100 hover:text-indigo-600">How It Works</a>
                </div>
                <!-- Auth Buttons (Mobile) -->
                <div id="nav-auth-mobile" class="px-5 pb-6">
                    <a href="#" onclick="app.navigateTo('auth', 'signup')" class="block w-full text-center bg-indigo-600 text-white px-5 py-2.5 rounded-lg font-medium shadow-md hover:bg-indigo-700 transition-all">
                        Sign Up
                    </a>
                    <a href="#" onclick="app.navigateTo('auth', 'login')" class="mt-3 block w-full text-center font-medium text-slate-700 hover:text-indigo-600 transition-colors">
                        Log In
                    </a>
                </div>
                <!-- Dashboard Button (Mobile, shown when logged in) -->
                <div id="nav-dashboard-mobile" class="hidden px-5 pb-6">
                    <span id="nav-welcome-mobile" class="block w-full text-center font-medium text-slate-700 mb-3"></span>
                    <a href="#" onclick="app.navigateTo('dashboard')" class="block w-full text-center bg-indigo-100 text-indigo-700 px-5 py-2.5 rounded-lg font-medium shadow-sm hover:bg-indigo-200 transition-all">
                        Dashboard
                    </a>
                    <a href="#" onclick="app.logout()" class="mt-3 block w-full text-center bg-indigo-600 text-white px-5 py-2.5 rounded-lg font-medium shadow-md hover:bg-indigo-700 transition-all">
                        Log Out
                    </a>
                </div>
            </div>
        </nav>

        <!-- Main Content Area (Dynamic) -->
        <main id="app-container" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <!-- Content will be injected here by JavaScript -->
        </main>

        <!-- Footer -->
        <footer class="bg-slate-900 text-slate-300 mt-32">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
                <div class="grid grid-cols-2 md:grid-cols-5 gap-8 mb-12">
                    <!-- Logo & Mission -->
                    <div class="col-span-2 md:col-span-2 pr-8">
                        <h3 class="text-3xl font-extrabold text-white brand-font mb-4">
                            <span class="bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent">TechieNova</span>
                        </h3>
                        <p class="text-slate-400 text-base leading-relaxed">Go from idea to done, faster. We connect you with verified expert talent and pre-built teams to accelerate your projects.</p>
                        <div class="flex gap-4 mt-6">
                            <a href="#" class="w-10 h-10 bg-slate-800 hover:bg-indigo-600 rounded-full flex items-center justify-center transition-colors">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2s9 5 20 5a9.5 9.5 0 00-9-5.5c4.75 2.25 7-7 7-7"/></svg>
                            </a>
                            <a href="#" class="w-10 h-10 bg-slate-800 hover:bg-indigo-600 rounded-full flex items-center justify-center transition-colors">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v 3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                            </a>
                            <a href="#" class="w-10 h-10 bg-slate-800 hover:bg-indigo-600 rounded-full flex items-center justify-center transition-colors">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
                            </a>
                        </div>
                    </div>
                    <!-- Platform -->
                    <div>
                        <h4 class="text-sm font-bold text-white tracking-wider uppercase mb-6">Platform</h4>
                        <ul class="space-y-3">
                            <li><a href="#" onclick="app.navigateTo('findTalent')" class="hover:text-indigo-400 transition-colors">Find Talent</a></li>
                            <li><a href="#" onclick="app.navigateTo('findWork')" class="hover:text-indigo-400 transition-colors">Find Work</a></li>
                            <li><a href="#" onclick="app.navigateTo('postProject')" class="hover:text-indigo-400 transition-colors">Post a Project</a></li>
                            <li><a href="#" class="hover:text-indigo-400 transition-colors">Our Blog</a></li>
                        </ul>
                    </div>
                    <!-- For Clients -->
                    <div>
                        <h4 class="text-sm font-bold text-white tracking-wider uppercase mb-6">For Clients</h4>
                        <ul class="space-y-3">
                            <li><a href="#" onclick="app.navigateTo('home', '#how-it-works')" class="hover:text-indigo-400 transition-colors">How It Works</a></li>
                            <li><a href="#" class="hover:text-indigo-400 transition-colors">Success Stories</a></li>
                            <li><a href="#" class="hover:text-indigo-400 transition-colors">Pricing</a></li>
                            <li><a href="#" class="hover:text-indigo-400 transition-colors">Security</a></li>
                        </ul>
                    </div>
                    <!-- Resources -->
                    <div>
                        <h4 class="text-sm font-bold text-white tracking-wider uppercase mb-6">Resources</h4>
                        <ul class="space-y-3">
                            <li><a href="#" class="hover:text-indigo-400 transition-colors">Help Center</a></li>
                            <li><a href="#" class="hover:text-indigo-400 transition-colors">API Docs</a></li>
                            <li><a href="#" class="hover:text-indigo-400 transition-colors">Status</a></li>
                            <li><a href="#" class="hover:text-indigo-400 transition-colors">Contact</a></li>
                        </ul>
                    </div>
                </div>
                <div class="border-t border-slate-800 pt-12">
                    <div class="flex flex-col md:flex-row justify-between items-center">
                        <p class="text-slate-500 text-sm">&copy; 2025 TechieNova. All rights reserved. | <a href="#" class="hover:text-indigo-400">Privacy Policy</a> | <a href="#" class="hover:text-indigo-400">Terms of Service</a></p>
                        <div class="mt-4 md:mt-0 flex gap-6">
                            <select class="bg-slate-800 text-slate-300 text-sm rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                <option>English</option>
                                <option>Spanish</option>
                                <option>French</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </footer>

    </div> <!-- End #app-shell -->


    <!-- 
      ============================================================
      FIREBASE & JAVASCRIPT APPLICATION
      ============================================================
    -->
    
    <!-- Firebase SDK Imports (FIXED: type_is_module="true" to type="module") -->
    <script type="module" src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"></script>

    <script type="module">
        // Import Firebase functions
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { 
            getAuth, 
            onAuthStateChanged, 
            signInAnonymously, 
            signInWithCustomToken,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            updateProfile,
            signOut,
            GoogleAuthProvider,
            GithubAuthProvider,
            signInWithPopup
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { 
            getFirestore, 
            doc, 
            getDoc, 
            setDoc,
            setLogLevel
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Firebase and App variables
        let fbApp, db, auth;
        
        // Use provided Firebase config and App ID
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        /**
         * Mock Database
         * Simulates data that would come from a backend server.
         */
        const mockDatabase = {
            freelancers: [
                {
                    id: 1,
                    name: "Momentum Labs",
                    title: "AI & Webflow Development Team",
                    rate: 150,
                    rating: 4.9,
                    jobs: 32,
                    verified: true,
                    skills: ["AI Integration", "Webflow", "React", "Node.js", "GPT-4", "API"],
                    bio: "We are a pre-built team of 2 developers and 1 designer. We build beautiful, AI-powered websites in record time. Our process is transparent and we guarantee results. We've worked with top-tier startups to scale their MVPs to full production applications.",
                    avatarUrl: "https://placehold.co/100x100/4f46e5/ffffff?text=ML",
                    isTeam: true,
                    portfolio: [
                        { title: "AI Chatbot for E-commerce", img: "https://placehold.co/600x400/e0e7ff/4f46e5?text=AI+Chatbot" },
                        { title: "SaaS Dashboard in React", img: "https://placehold.co/600x400/e0e7ff/4f46e5?text=SaaS+Dashboard" },
                    ],
                    reviews: [
                        { name: "Client from TechCorp", rating: 5, text: "Momentum Labs delivered ahead of schedule and exceeded all expectations. True professionals." },
                        { name: "Startup Founder", rating: 5, text: "The best team I've ever hired. Their AI integration was flawless." },
                    ]
                },
                {
                    id: 2,
                    name: "Sarah Jenkins",
                    title: "Senior Product Designer (UX/UI)",
                    rate: 95,
                    rating: 5.0,
                    jobs: 58,
                    verified: true,
                    skills: ["UX Design", "Figma", "User Research", "Prototyping", "Mobile App Design"],
                    bio: "I craft user-centric and beautiful digital experiences. Ex-Google designer with a passion for startups. My focus is on creating intuitive flows that solve real user problems and drive business goals.",
                    avatarUrl: "https://placehold.co/100x100/ec4899/ffffff?text=SJ",
                    isTeam: false,
                    portfolio: [
                        { title: "Fintech Mobile App", img: "https://placehold.co/600x400/fce7f3/ec4899?text=Fintech+App" },
                        { title: "B2B SaaS Platform", img: "https://placehold.co/600x400/fce7f3/ec4899?text=B2B+SaaS" },
                        { title: "Marketplace Redesign", img: "https://placehold.co/600x400/fce7f3/ec4899?text=Marketplace" },
                    ],
                    reviews: [
                        { name: "CEO of Innovate", rating: 5, text: "Sarah's designs are world-class. She completely transformed our user retention." },
                        { name: "Product Manager", rating: 5, text: "Incredibly collaborative and insightful. Her user research was a game-changer." },
                    ]
                },
                {
                    id: 3,
                    name: "Alex Chen",
                    title: "Full-Stack Python Developer",
                    rate: 80,
                    rating: 4.8,
                    jobs: 41,
                    verified: true,
                    skills: ["Python", "Django", "React", "PostgreSQL", "AWS", "Docker"],
                    bio: "Backend specialist with 8+ years of experience in scaling complex applications. Let's build something robust. I am comfortable with the full stack, from DevOps on AWS to pixel-perfect frontend React components.",
                    avatarUrl: "https://placehold.co/100x100/10b981/ffffff?text=AC",
                    isTeam: false,
                    portfolio: [
                        { title: "Real-time Analytics API", img: "https://placehold.co/600x400/d1fae5/10b981?text=Analytics+API" },
                    ],
                    reviews: [
                        { name: "CTO @ DataCo", rating: 5, text: "Alex is a rockstar. Clean code, great communication, and always reliable." },
                    ]
                },
                {
                    id: 4,
                    name: "Design Co-op",
                    title: "Brand & Marketing Design Team",
                    rate: 120,
                    rating: 4.9,
                    jobs: 24,
                    verified: true,
                    skills: ["Branding", "Logo Design", "Social Media", "Web Design", "Figma"],
                    bio: "A collective of 3 brand strategists and designers. We build memorable brands from the ground up.",
                    avatarUrl: "https://placehold.co/100x100/f59e0b/ffffff?text=DC",
                    isTeam: true,
                    portfolio: [
                        { title: "Startup Rebrand", img: "https://placehold.co/600x400/fef3c7/f59e0b?text=Rebrand" },
                        { title: "Social Media Campaign", img: "https://placehold.co/600x400/fef3c7/f59e0b?text=Social+Campaign" },
                    ],
                    reviews: [
                        { name: "Marketing Director", rating: 5, text: "They just *get it*. Our new brand is incredible." },
                    ]
                },
                {
                    id: 5,
                    name: "Mike Thompson",
                    title: "SEO & Content Strategist",
                    rate: 70,
                    rating: 4.7,
                    jobs: 75,
                    verified: false,
                    skills: ["SEO", "Content Writing", "Copywriting", "Analytics", "Semrush"],
                    bio: "I help businesses get found on Google. Proven track record of increasing organic traffic by over 200%.",
                    avatarUrl: "https://placehold.co/100x100/6366f1/ffffff?text=MT",
                    isTeam: false,
                    portfolio: [],
                    reviews: [
                        { name: "E-commerce Owner", rating: 5, text: "Our traffic has tripled since hiring Mike." },
                    ]
                },
                {
                    id: 6,
                    name: "TechTitans",
                    title: "Mobile App Team (iOS & Android)",
                    rate: 180,
                    rating: 5.0,
                    jobs: 19,
                    verified: true,
                    skills: ["React Native", "Swift", "Kotlin", "Firebase", "Node.js"],
                    bio: "Dedicated team for native & cross-platform mobile apps. We've launched 20+ apps to the app stores.",
                    avatarUrl: "https://placehold.co/100x100/3b82f6/ffffff?text=TT",
                    isTeam: true,
                    portfolio: [
                        { title: "Fitness Tracking App", img: "https://placehold.co/600x400/dbeafe/3b82f6?text=Fitness+App" },
                    ],
                    reviews: [
                        { name: "Wellness Startup CEO", rating: 5, text: "Flawless execution. Our app is fast, bug-free, and looks amazing." },
                    ]
                },
            ],
            projects: [
                {
                    id: 1,
                    title: "Build a modern website for a new coffee shop",
                    description: "Looking for a high-end, modern website for my new specialty coffee shop. Needs to look beautiful, have an online menu, and a small 'about' section. Open to Webflow or custom code.\n\n**Key Requirements:**\n- Homepage with photo gallery\n- Online menu page (static, not for ordering)\n- 'About Us' page with our story\n- Contact form\n\nThe design should be minimalist, elegant, and mobile-first. Please provide examples of your previous work.",
                    budget: 2500,
                    skills: ["Web Design", "Webflow", "Copywriting", "Mobile Design"],
                    client: { name: "Java House", rating: 4.9, history: "3 projects posted, 100% hire rate" },
                    posted: "2 hours ago",
                },
                {
                    id: 2,
                    title: "AI chatbot integration for Shopify store",
                    description: "I need an expert to integrate an AI-powered customer service chatbot (like OpenAI's GPT) into my Shopify store to handle common questions about shipping and returns.\n\nYou will be responsible for:\n- Setting up the connection to the OpenAI API\n- Training the bot on our store's shipping/return policies\n- Integrating the chat widget into our Shopify theme\n- Must have experience with Node.js and Shopify APIs.",
                    budget: 1500,
                    skills: ["AI Integration", "Shopify", "Node.js", "APIs", "GPT"],
                    client: { name: "GadgetGo", rating: 4.5, history: "1 project posted, new client" },
                    posted: "1 day ago",
                },
                {
                    id: 3,
                    title: "Rebrand and new logo for a tech startup",
                    description: "We are a B2B SaaS startup and we've outgrown our current brand. We need a full rebrand: new logo, color palette, typography, and brand guidelines.\n\nWe are looking for a top-tier designer or agency who can understand our mission and translate it into a compelling visual identity. The final deliverable must be a comprehensive brand guidelines PDF.",
                    budget: 8000,
                    skills: ["Branding", "Logo Design", "Strategy", "Graphic Design"],
                    client: { name: "Innovate Inc.", rating: 5.0, history: "12 projects posted, $50k+ spent" },
                    posted: "3 days ago",
                },
                {
                    id: 4,
                    title: "Monthly blog content (4 articles) on finance",
                    description: "Seeking a knowledgeable finance writer for a long-term engagement. We need 4 high-quality, SEO-optimized blog posts per month (1500 words each) on topics related to personal investing.\n\nTopics will include: \n- Retirement planning\n- Stock market analysis\n- Personal budgeting strategies\n\nPlease provide at least 3 samples of your writing.",
                    budget: 1200,
                    skills: ["Content Writing", "SEO", "Finance"],
                    client: { name: "MyMoneyGuide", rating: 4.8, history: "5 projects posted, $4k+ spent" },
                    posted: "5 days ago",
                },
            ]
        };

        /**
         * Main Application State
         * Manages the current view, logged-in user, etc.
         */
        const appState = {
            currentPage: 'home',
            currentUser: null, // Will be populated by onAuthStateChanged
            authReady: false,  // Becomes true after first auth check
        };

        /**
         * Main App Object
         * Contains all methods for rendering and app logic.
         */
        const app = {
            // --- CORE APP ---
            init() {
                this.initFirebase(); // Start Firebase and auth listener
                this.setupEventListeners(); // Setup clicks for mobile menu, etc.
                this.navigateTo(appState.currentPage); // Render initial page
            },
            
            async initFirebase() {
                try {
                    fbApp = initializeApp(firebaseConfig);
                    db = getFirestore(fbApp);
                    auth = getAuth(fbApp);
                    
                    // Enable Firestore logging for debugging
                    setLogLevel('Debug');

                    // Sign in with token or anonymously
                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                        await signInWithCustomToken(auth, __initial_auth_token);
                    } else {
                        await signInAnonymously(auth);
                    }

                    // *** CENTRAL AUTH LISTENER ***
                    // This is the new source of truth for user state
                    onAuthStateChanged(auth, async (user) => {
                        const previousPage = appState.currentPage;
                        
                        if (user && !user.isAnonymous) {
                            // User is signed in
                            const userId = user.uid;
                            const userProfileRef = doc(db, `artifacts/${appId}/users/${userId}/profile`, "details");
                            const profileSnap = await getDoc(userProfileRef);

                            let userType = 'client'; // Default
                            let userName = user.displayName;

                            if (profileSnap.exists()) {
                                userType = profileSnap.data().type;
                                userName = profileSnap.data().name; // Use Firestore name as source of truth
                            }

                            appState.currentUser = {
                                uid: userId,
                                name: userName,
                                email: user.email,
                                type: userType
                            };
                            
                            // If user just logged in or signed up, send to dashboard
                            if (previousPage === 'auth') {
                                this.navigateTo('dashboard');
                            }

                        } else {
                            // User is signed out or anonymous
                            appState.currentUser = null;
                            
                            // If user was on a private page, send to home
                            if (previousPage === 'dashboard' || previousPage.includes('Profile')) {
                                this.navigateTo('home');
                            }
                        }
                        
                        appState.authReady = true;
                        this.renderNavbar(); // Re-render navbar on every auth change
                    });

                } catch (error) {
                    console.error("Firebase Init Error:", error);
                    document.getElementById('app-container').innerHTML = `<p>Error initializing application. Please check console.</p>`;
                }
            },

            setupEventListeners() {
                // Mobile menu toggle
                const menuButton = document.getElementById('mobile-menu-button');
                const mobileMenu = document.getElementById('mobile-menu');
                const openIcon = document.getElementById('menu-open-icon');
                const closeIcon = document.getElementById('menu-close-icon');

                menuButton.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                    openIcon.classList.toggle('hidden');
                    closeIcon.classList.toggle('hidden');
                });

                // Close mobile menu on nav
                mobileMenu.addEventListener('click', (e) => {
                    if (e.target.tagName === 'A') {
                        mobileMenu.classList.add('hidden');
                        openIcon.classList.remove('hidden');
                        closeIcon.classList.add('hidden');
                    }
                });

                // Global click handler for dynamic content
                document.getElementById('app-container').addEventListener('click', (e) => {
                    // AI Brief Analyzer Button
                    if (e.target.id === 'analyze-brief-button' || e.target.closest('#analyze-brief-button')) {
                        e.preventDefault();
                        this.handleAiBrief();
                    }
                    // Auth Page: Show/Hide Form
                    if (e.target.dataset.authAction === 'show-form') {
                        e.preventDefault();
                        this.showAuthForm(e.target.dataset.formType, e.target.dataset.userType);
                    }
                    // NOTE: Auth form submission is now handled by 'onsubmit' on the form element
                });
            },

            /**
             * Updates the navbar based on login state
             */
            renderNavbar() {
                const { currentUser } = appState;
                const authDesktop = document.getElementById('nav-auth-desktop');
                const authMobile = document.getElementById('nav-auth-mobile');
                const dashDesktop = document.getElementById('nav-dashboard-desktop');
                const dashMobile = document.getElementById('nav-dashboard-mobile');
                
                if (currentUser) {
                    // Logged In
                    authDesktop.classList.add('hidden');
                    authMobile.classList.add('hidden');
                    dashDesktop.classList.remove('hidden');
                    dashMobile.classList.remove('hidden');
                    
                    document.getElementById('nav-welcome').textContent = `Welcome, ${currentUser.name}!`;
                    document.getElementById('nav-welcome-mobile').textContent = `Welcome, ${currentUser.name}!`;

                } else {
                    // Logged Out
                    authDesktop.classList.remove('hidden');
                    authMobile.classList.remove('hidden');
                    dashDesktop.classList.add('hidden');
                    dashMobile.classList.add('hidden');
                }
            },

            /**
             * Main router. Renders the correct page into #app-container
             */
            navigateTo(page, param = null) {
                appState.currentPage = page;
                const container = document.getElementById('app-container');
                
                // Close mobile menu on any navigation
                document.getElementById('mobile-menu').classList.add('hidden');
                document.getElementById('menu-open-icon').classList.remove('hidden');
                document.getElementById('menu-close-icon').classList.add('hidden');

                switch (page) {
                    case 'home':
                        container.innerHTML = this.renderHomepage();
                        break;
                    case 'findTalent':
                        container.innerHTML = this.renderFindTalent();
                        break;
                    case 'findWork':
                        container.innerHTML = this.renderFindWork();
                        break;
                    case 'postProject':
                        // Protect this route
                        if (!appState.currentUser) {
                            this.navigateTo('auth', 'login');
                            return;
                        }
                        container.innerHTML = this.renderPostProject();
                        break;
                    case 'auth':
                        container.innerHTML = this.renderAuthPage(param); // anchor can be 'login' or 'signup'
                        break;
                    case 'dashboard':
                        // Protect this route
                        if (!appState.currentUser) {
                            this.navigateTo('auth', 'login');
                            return;
                        }
                        container.innerHTML = this.renderDashboard();
                        break;
                    case 'freelancerProfile':
                        container.innerHTML = this.renderFreelancerProfile(param);
                        break;
                    case 'projectDetail':
                        container.innerHTML = this.renderProjectDetail(param);
                        break;
                    default:
                        container.innerHTML = this.renderHomepage();
                }

                // Handle anchors for scrolling
                if (param && param.startsWith('#')) {
                    setTimeout(() => {
                        document.querySelector(param)?.scrollIntoView();
                    }, 0);
                } else {
                    window.scrollTo(0, 0);
                }
            },
            
            // --- NEW AUTH FUNCTIONS ---
            
            async handleAuthFormSubmit(event, formType, userType) {
                event.preventDefault();
                this.showError(''); // Clear previous errors
                
                const email = event.target.email.value;
                const password = event.target.password.value;
                
                if (formType === 'login') {
                    await this.submitLogin(email, password);
                } else if (formType === 'signup') {
                    const name = event.target.name.value;
                    if (!name) {
                        this.showError("Please enter your full name.");
                        return;
                    }
                    await this.submitSignup(name, email, password, userType);
                }
            },

            async submitLogin(email, password) {
                try {
                    await signInWithEmailAndPassword(auth, email, password);
                    // onAuthStateChanged will handle navigation
                } catch (error) {
                    this.showError(this.formatFirebaseError(error.message));
                }
            },
            
            async submitSignup(name, email, password, userType) {
                try {
                    // 1. Create user in Auth
                    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                    const user = userCredential.user;

                    // 2. Update Auth profile (for display name)
                    await updateProfile(user, { displayName: name });

                    // 3. Create user profile in Firestore (for custom data like 'type')
                    const userId = user.uid;
                    const userProfileRef = doc(db, `artifacts/${appId}/users/${userId}/profile`, "details");
                    
                    await setDoc(userProfileRef, {
                        name: name,
                        email: email,
                        type: userType,
                        createdAt: new Date()
                    });
                    
                    // onAuthStateChanged will handle navigation and state update

                } catch (error) {
                    this.showError(this.formatFirebaseError(error.message));
                }
            },

            /**
             * NEW: Handles social login (Google, GitHub)
             * @param {string} providerType - 'google' or 'github'
             * @param {string|null} userType - 'client', 'freelancer', or null (if logging in)
             */
            async handleSocialLogin(providerType, userType = null) {
                this.showError(''); // Clear errors
                let provider;
                if (providerType === 'google') {
                    provider = new GoogleAuthProvider();
                } else if (providerType === 'github') {
                    provider = new GithubAuthProvider();
                } else {
                    return;
                }

                try {
                    const result = await signInWithPopup(auth, provider);
                    const user = result.user;
                    
                    // Check if user exists in Firestore
                    const userId = user.uid;
                    const userProfileRef = doc(db, `artifacts/${appId}/users/${userId}/profile`, "details");
                    const profileSnap = await getDoc(userProfileRef);

                    if (!profileSnap.exists()) {
                        // This is a new user
                        if (userType) {
                            // This is a SIGNUP flow. Create the profile.
                            await setDoc(userProfileRef, {
                                name: user.displayName,
                                email: user.email,
                                type: userType,
                                createdAt: new Date()
                            });
                            // onAuthStateChanged will handle the rest
                        } else {
                            // This is a LOGIN flow for a new user.
                            // Log them out and show an error.
                            await signOut(auth);
                            this.showError("No account found. Please sign up first.");
                        }
                    } else {
                        // This is a returning user. onAuthStateChanged will log them in.
                    }

                } catch (error) {
                    this.showError(this.formatFirebaseError(error.message));
                }
            },

            logout() {
                signOut(auth).catch((error) => {
                    console.error("Logout Error:", error);
                });
                // onAuthStateChanged will handle navigation
            },
            
            showError(message) {
                const errorEl = document.getElementById('auth-error');
                if (errorEl) {
                    errorEl.textContent = message;
                }
            },
            
            formatFirebaseError(message) {
                // Makes Firebase errors friendlier
                if (message.includes("auth/invalid-credential")) {
                    return "Invalid email or password. Please try again.";
                }
                if (message.includes("auth/email-already-in-use")) {
                    return "An account with this email already exists.";
                }
                if (message.includes("auth/weak-password")) {
                    return "Password should be at least 6 characters long.";
                }
                if (message.includes("auth/account-exists-with-different-credential")) {
                    return "An account already exists with this email using a different sign-in method (e.g., Google). Try that method instead.";
                }
                return "An unknown error occurred. Please try again.";
            },

            // --- PAGE RENDERERS ---

            /**
             * Renders the Homepage
             */
            renderHomepage() {
                return `
                    <!-- Hero Section -->
                    <section class="text-center py-24 md:py-32">
                        <div class="max-w-4xl mx-auto px-4">
                            <span class="inline-block bg-indigo-100 text-indigo-700 text-sm font-semibold px-4 py-2 rounded-full mb-6">✨ The Future of Freelancing</span>
                            <h1 class="text-5xl md:text-7xl font-extrabold brand-font leading-tight text-slate-900 mb-6">
                                Go from <span class="bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Idea</span> to <span class="bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Done,</span> <span class="bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Faster.</span>
                            </h1>
                            <p class="mt-6 max-w-3xl mx-auto text-xl md:text-2xl text-slate-600 leading-relaxed mb-12">
                                Stop searching. Start accelerating. Our AI matches you with verified expert freelancers and pre-built teams in minutes.
                            </p>
                            
                            <!-- Trust Badge -->
                            <div class="flex flex-col md:flex-row justify-center items-center gap-8 mb-12 text-slate-600">
                                <div class="flex items-center gap-2">
                                    <svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>
                                    <span class="font-medium">500+ Verified Experts</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>
                                    <span class="font-medium">4.9★ Average Rating</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>
                                    <span class="font-medium">$2M+ Projects Completed</span>
                                </div>
                            </div>
                            
                            <div class="mt-12 flex flex-col sm:flex-row justify-center gap-4">
                                <button onclick="app.navigateTo('postProject')" class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white text-lg font-semibold py-4 px-10 rounded-xl shadow-xl hover:shadow-2xl hover:from-indigo-700 hover:to-purple-700 transition-all duration-300 transform hover:-translate-y-1">
                                    Find Talent Now
                                </button>
                                <button onclick="app.navigateTo('findWork')" class="bg-white text-indigo-600 text-lg font-semibold py-4 px-10 rounded-xl shadow-lg border-2 border-indigo-600 hover:bg-indigo-50 transition-all duration-300">
                                    Browse Projects
                                </button>
                            </div>
                        </div>
                    </section>

                    <!-- Stats Section -->
                    <section class="py-16 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl my-16">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                            <div>
                                <div class="stat-number">5000+</div>
                                <p class="text-slate-600 text-lg font-medium mt-2">Active Projects</p>
                            </div>
                            <div>
                                <div class="stat-number">98%</div>
                                <p class="text-slate-600 text-lg font-medium mt-2">Success Rate</p>
                            </div>
                            <div>
                                <div class="stat-number">24h</div>
                                <p class="text-slate-600 text-lg font-medium mt-2">Avg. Response Time</p>
                            </div>
                        </div>
                    </section>

                    <!-- "How It Works" Section -->
                    <section id="how-it-works" class="py-24">
                        <h2 class="text-4xl md:text-5xl font-bold text-center text-slate-900 mb-4 brand-font">How It Works</h2>
                        <p class="text-center text-xl text-slate-600 mb-16 max-w-2xl mx-auto">Get matched with top talent in just 3 simple steps</p>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                            <!-- Step 1 -->
                            <div class="bg-white p-8 rounded-2xl shadow-lg card-hover border-t-4 border-indigo-600">
                                <div class="w-16 h-16 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full flex items-center justify-center mb-6">
                                    <svg class="w-8 h-8 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                                      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                                    </svg>
                                </div>
                                <h3 class="text-2xl font-bold text-slate-900 brand-font">Post Your Brief</h3>
                                <p class="mt-3 text-slate-600">Describe your project in plain English. Our AI analyzes your needs and suggests the perfect match.</p>
                            </div>
                            <!-- Step 2 -->
                            <div class="bg-white p-8 rounded-2xl shadow-lg card-hover border-t-4 border-purple-600">
                                <div class="w-16 h-16 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full flex items-center justify-center mb-6">
                                    <svg class="w-8 h-8 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                                      <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 00-12.728 0m12.728 0A8.966 8.966 0 0118 9.75c0-5.02-4.03-9-9-9s-9 3.98-9 9c0 3.064 1.513 5.8 3.786 7.472M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                                <h3 class="text-2xl font-bold text-slate-900 brand-font">Get Matched</h3>
                                <p class="mt-3 text-slate-600">Instantly get a curated list of top-tier talent. Review portfolios, ratings, and previous work.</p>
                            </div>
                            <!-- Step 3 -->
                            <div class="bg-white p-8 rounded-2xl shadow-lg card-hover border-t-4 border-pink-600">
                                <div class="w-16 h-16 bg-gradient-to-r from-pink-600 to-red-600 rounded-full flex items-center justify-center mb-6">
                                    <svg class="w-8 h-8 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                                      <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h6m3-3.75l-3 3m0 0l-3-3m3 3V1.5m6 5.25v11.25m6-11.25v11.25m0 0h-6.375c-.621 0-1.125-.504-1.125-1.125V11.25c0-.621.504-1.125 1.125-1.125H19.5z" />
                                    </svg>
                                </div>
                                <h3 class="text-2xl font-bold text-slate-900 brand-font">Collaborate & Pay</h3>
                                <p class="mt-3 text-slate-600">Manage projects securely. Pay only when milestones are completed to your satisfaction.</p>
                            </div>
                        </div>
                    </section>

                    <!-- Categories Section -->
                    <section class="py-24">
                        <h2 class="text-4xl md:text-5xl font-bold text-center text-slate-900 mb-4 brand-font">Explore Top Categories</h2>
                        <p class="text-center text-xl text-slate-600 mb-16 max-w-2xl mx-auto">Find expert talent in any field you need</p>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                            ${this.renderCategoryCard("🤖 AI & ML", "#667eea")}
                            ${this.renderCategoryCard("💻 Web Development", "#764ba2")}
                            ${this.renderCategoryCard("🎨 Design & UX", "#f093fb")}
                            ${this.renderCategoryCard("✍️ Writing & Content", "#f5576c")}
                        </div>
                    </section>
                `;
            },

            renderCategoryCard(title, gradientStart) {
                const colors = {
                    "#667eea": "from-indigo-600 to-purple-600",
                    "#764ba2": "from-purple-600 to-pink-600",
                    "#f093fb": "from-pink-600 to-red-600",
                    "#f5576c": "from-red-600 to-orange-600"
                };
                return `
                    <div class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer overflow-hidden group">
                        <div class="absolute inset-0 bg-gradient-to-br ${colors[gradientStart]} opacity-0 group-hover:opacity-5 transition-opacity duration-300"></div>
                        <h3 class="text-xl font-bold text-slate-900 relative">${title}</h3>
                        <p class="mt-3 text-indigo-600 font-semibold relative flex items-center group-hover:translate-x-2 transition-transform">Explore Now <span class="ml-2">→</span></p>
                    </div>
                `;
            },

            /**
             * Renders the "Find Talent" page
             */
            renderFindTalent() {
                return `
                    <div class="mb-12">
                        <h1 class="text-5xl font-bold text-slate-900 mb-3 brand-font">Find Top Talent</h1>
                        <p class="text-xl text-slate-600">Browse our curated network of verified experts and pre-vetted teams ready to deliver excellence.</p>
                    </div>
                    
                    <!-- Filters -->
                    <div class="bg-white p-6 rounded-2xl shadow-lg mb-12 border border-slate-100">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Search Skills</label>
                                <input type="text" placeholder="React, Figma, Python..." class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Hourly Rate</label>
                                <select class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                                    <option>Any Rate</option>
                                    <option>$0 - $50/hr</option>
                                    <option>$50 - $100/hr</option>
                                    <option>$100+/hr</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Availability</label>
                                <select class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                                    <option>Any</option>
                                    <option>Available Now</option>
                                    <option>Available Soon</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">&nbsp;</label>
                                <button class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:shadow-lg hover:from-indigo-700 hover:to-purple-700 transition-all duration-300">
                                    🔍 Search
                                </button>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="flex items-center space-x-3 text-slate-700 font-medium">
                                <input type="checkbox" class="h-5 w-5 text-indigo-600 rounded border-slate-300 focus:ring-indigo-500">
                                <span>Show only verified & top-rated talent</span>
                            </label>
                        </div>
                    </div>

                    <!-- Freelancer List -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        ${mockDatabase.freelancers.map(f => this.renderFreelancerCard(f)).join('')}
                    </div>
                `;
            },

            /**
             * Renders a single freelancer card
             */
            renderFreelancerCard(freelancer) {
                return `
                    <div class="bg-white rounded-2xl shadow-lg card-hover overflow-hidden border border-slate-100">
                        <div class="p-8">
                            <div class="flex items-center space-x-4 mb-6">
                                <img src="${freelancer.avatarUrl}" alt="${freelancer.name}" class="w-20 h-20 rounded-full border-4 border-gradient-to-r from-indigo-600 to-purple-600 shadow-md">
                                <div class="flex-1">
                                    <h3 class="text-xl font-bold text-slate-900 flex items-center brand-font">
                                        ${freelancer.name}
                                        ${freelancer.verified ? `
                                            <svg class="w-5 h-5 text-green-500 ml-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                                            </svg>
                                        ` : ''}
                                    </h3>
                                    <p class="text-slate-600 text-sm font-medium">${freelancer.title}</p>
                                </div>
                            </div>
                            
                            ${freelancer.isTeam ? `<span class="inline-block bg-indigo-100 text-indigo-800 text-xs font-bold px-3 py-1 rounded-full mb-4 uppercase tracking-wider">⭐ Pre-Vetted Team</span>` : ''}

                            <p class="text-slate-700 h-20 overflow-hidden text-sm mb-4">${freelancer.bio}</p>

                            <div class="mb-4">
                                ${freelancer.skills.slice(0, 3).map(skill => `<span class="inline-block bg-slate-100 text-slate-700 text-xs font-semibold px-3 py-1 rounded-full mr-2 mb-2">${skill}</span>`).join('')}
                                ${freelancer.skills.length > 3 ? `<span class="inline-block bg-slate-100 text-slate-700 text-xs font-semibold px-3 py-1 rounded-full mr-2 mb-2">+${freelancer.skills.length - 3} more</span>` : ''}
                            </div>

                            <div class="flex justify-between items-center py-4 border-y border-slate-100">
                                <div>
                                    <span class="text-2xl font-bold text-slate-900">$${freelancer.rate}</span>
                                    <span class="text-slate-600 text-sm">/hr</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <svg class="w-5 h-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10.868 2.884c.321-.662 1.134-.662 1.456 0l1.833 3.791c.16.33.461.558.82.606l4.179.607c.725.105 1.018.99 1.411.543-.3 1.06-.411-1.096-.543-1.411l-4.179-.607a1.125 1.125 0 01-.82-.606L10.868 2.884zM10 12.585l-3.418 1.797a.75.75 0 01-1.088-1.01l.653-3.805a.75.75 0 00-.216-.664l-2.768-2.697a.75.75 0 01.416-1.28l3.82-.555a.75.75 0 00.56-.41L9.13 2.11a.75.75 0 011.34 0l1.71 3.47a.75.75 0 00.56.41l3.82.555a.75.75 0 01.416 1.28l-2.768 2.697a.75.75 0 00-.216.664l.653 3.805a.75.75 0 01-1.088 1.01L10 12.585z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="text-lg font-bold text-slate-700">${freelancer.rating}</span>
                                    <span class="text-sm text-slate-500">(${freelancer.jobs} jobs)</span>
                                </div>
                            </div>

                            <button onclick="app.navigateTo('freelancerProfile', ${freelancer.id})" class="mt-4 w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:shadow-lg hover:from-indigo-700 hover:to-purple-700 transition-all duration-300">
                                View Profile
                            </button>
                        </div>
                    </div>
                `;
            },
            
            /**
             * Renders the "Find Work" page
             */
            renderFindWork() {
                 return `
                    <div class="mb-12">
                        <h1 class="text-5xl font-bold text-slate-900 mb-3 brand-font">Discover Your Next Project</h1>
                        <p class="text-xl text-slate-600">Browse hand-picked projects from vetted clients. Find work that matches your skills and goals.</p>
                    </div>
                    
                    <!-- Filters -->
                    <div class="bg-white p-6 rounded-2xl shadow-lg mb-12 border border-slate-100">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Search Keywords</label>
                                <input type="text" placeholder="React, Logo Design, Copywriting..." class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Budget Range</label>
                                <select class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                                    <option>Any Budget</option>
                                    <option>$100 - $500</option>
                                    <option>$500 - $2,000</option>
                                    <option>$2,000 - $10,000</option>
                                    <option>$10,000+</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Project Type</label>
                                <select class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                                    <option>Any Type</option>
                                    <option>One-time Project</option>
                                    <option>Ongoing Work</option>
                                    <option>Contract</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">&nbsp;</label>
                                <button class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:shadow-lg hover:from-indigo-700 hover:to-purple-700 transition-all duration-300">
                                    🔍 Search
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Project List -->
                    <div class="space-y-6">
                        ${mockDatabase.projects.map(p => this.renderProjectCard(p)).join('')}
                    </div>
                `;
            },
            
            /**
             * Renders a single project card
             */
            renderProjectCard(project) {
                return `
                    <div class="bg-white rounded-2xl shadow-lg card-hover overflow-hidden border-l-4 border-indigo-600 transition-all">
                        <div class="p-8">
                            <div class="flex flex-col md:flex-row justify-between md:items-start gap-4 mb-6">
                                <div class="flex-1">
                                    <h3 class="text-2xl font-bold text-slate-900 brand-font">
                                        <a href="#" onclick="app.navigateTo('projectDetail', ${project.id})" class="hover:text-indigo-600 cursor-pointer transition-colors">${project.title}</a>
                                    </h3>
                                </div>
                                <div class="text-right">
                                    <span class="text-4xl font-extrabold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">$${project.budget.toLocaleString()}</span>
                                    <p class="text-slate-600 font-medium">Budget</p>
                                </div>
                            </div>
                            
                            <p class="text-slate-600 text-base leading-relaxed mb-4 line-clamp-2">${project.description.substring(0, 150)}...</p>
                            
                            <div class="mb-6 flex flex-wrap gap-2">
                                ${project.skills.slice(0, 4).map(skill => `<span class="inline-block bg-slate-100 text-slate-700 text-sm font-semibold px-3 py-1 rounded-full">${skill}</span>`).join('')}
                            </div>
                            
                            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 py-4 border-t border-slate-100">
                                <div>
                                    <span class="font-semibold text-slate-900">By ${project.client.name}</span>
                                    <div class="flex items-center space-x-1 mt-1">
                                        <svg class="w-4 h-4 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10.868 2.884c.321-.662 1.134-.662 1.456 0l1.833 3.791c.16.33.461.558.82.606l4.179.607c.725.105 1.018.99 1.411.543-.3 1.06-.411-1.096-.543-1.411l-4.179-.607a1.125 1.125 0 01-.82-.606L10.868 2.884zM10 12.585l-3.418 1.797a.75.75 0 01-1.088-1.01l.653-3.805a.75.75 0 00-.216-.664l-2.768-2.697a.75.75 0 01.416-1.28l3.82-.555a.75.75 0 00.56-.41L9.13 2.11a.75.75 0 011.34 0l1.71 3.47a.75.75 0 00.56.41l3.82.555a.75.75 0 01.416 1.28l-2.768 2.697a.75.75 0 00-.216.664l.653 3.805a.75.75 0 01-1.088 1.01L10 12.585z" clip-rule="evenodd" /></svg>
                                        <span class="text-sm font-bold text-slate-700">${project.client.rating}</span>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2 text-sm text-slate-500">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M5.5 13a3.5 3.5 0 01-.369-6.98 4 4 0 117.753-1.3A4.5 4.5 0 1113.5 13H11V9.413l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13H5.5z"/></svg>
                                    <span>${project.posted}</span>
                                </div>
                            </div>
                            <button onclick="app.navigateTo('projectDetail', ${project.id})" class="mt-4 w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:shadow-lg hover:from-indigo-700 hover:to-purple-700 transition-all duration-300">
                                View & Apply
                            </button>
                        </div>
                    </div>
                `;
            },
            
            /**
             * Renders the "Post a Project" page with AI brief
             */
            renderPostProject() {
                return `
                    <div class="max-w-3xl mx-auto">
                        <h1 class="text-4xl font-bold text-slate-900 mb-2">Post a Project</h1>
                        <p class="text-lg text-slate-600 mb-8">Let's get your project started. Describe your needs, and our AI will help build your brief.</p>

                        <div class="bg-white p-8 rounded-xl shadow-lg">
                            <div class="mb-6">
                                <label for="ai-brief" class="block text-lg font-semibold text-slate-800 mb-2">Describe your project</label>
                                <p class="text-sm text-slate-600 mb-3">Just type in plain English. For example: "I need a new website for my coffee shop, needs to look modern and have an online menu."</p>
                                <textarea id="ai-brief" rows="6" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none text-base" placeholder="I need..."></textarea>
                            </div>
                            
                            <button id="analyze-brief-button" class="w-full bg-indigo-600 text-white text-lg font-semibold py-4 px-10 rounded-xl shadow-lg hover:bg-indigo-700 transition-all flex items-center justify-center">
                                <!-- Heroicon: sparkes -->
                                <svg class="w-6 h-6 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM18 12.75l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 18l-1.035.259a3.375 3.375 0 00-2.456 2.456L18 21.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 18l1.036.259a3.375 3.375 0 002.455 2.456L18 12.75z" />
                                </svg>
                                <span>Analyze My Brief</span>
                            </button>

                            <!-- AI Results - Hidden by default -->
                            <div id="ai-results" class="hidden mt-8 pt-8 border-t border-slate-200">
                                <div id="ai-loading" class="flex flex-col items-center">
                                    <div class="spinner"></div>
                                    <p class="mt-4 text-slate-600 font-medium">Analyzing your brief...</p>
                                </div>
                                
                                <div id="ai-form" class="hidden">
                                    <h3 class="text-2xl font-semibold text-slate-900 mb-6">Here's what we suggest:</h3>
                                    
                                    <div class="mb-4">
                                        <label for="project-title" class="block text-sm font-medium text-slate-700 mb-1">Project Title</label>
                                        <input type="text" id="project-title" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none" value="Modern Website for Coffee Shop">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="project-skills" class="block text-sm font-medium text-slate-700 mb-1">Suggested Skills</label>
                                        <input type="text" id="project-skills" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none" value="Web Design, Webflow, Copywriting, SEO">
                                    </div>
                                    
                                    <div class="mb-6">
                                        <label for="project-budget" class="block text-sm font-medium text-slate-700 mb-1">Suggested Budget (USD)</label>
                                        <input type="text" id="project-budget" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none" value="$2,000 - $4,500">
                                    </div>
                                    
                                    <fieldset class="mb-6">
                                        <legend class="block text-lg font-semibold text-slate-800 mb-3">Who are you looking for?</legend>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <label class="flex p-6 bg-slate-50 border-2 border-slate-200 rounded-lg cursor-pointer hover:border-indigo-500">
                                                <input type="radio" name="hire-type" class="text-indigo-600 focus:ring-indigo-500" checked>
                                                <span class="ml-4">
                                                    <span class="block text-base font-semibold text-slate-900">An Individual</span>
                                                    <span class="block text-sm text-slate-600">Find a single expert for the job.</span>
                                                </span>
                                            </label>
                                            <label class="flex p-6 bg-slate-50 border-2 border-slate-200 rounded-lg cursor-pointer hover:border-indigo-500">
                                                <input type="radio" name="hire-type" class="text-indigo-600 focus:ring-indigo-500">
                                                <span class="ml-4">
                                                    <span class="block text-base font-semibold text-slate-900">A Pre-Vetted Team</span>
                                                    <span class="block text-sm text-slate-600">Hire a full team that works together.</span>
                                                </span>
                                            </label>
                                        </div>
                                    </fieldset>
                                    
                                    <button class="w-full bg-indigo-600 text-white text-lg font-semibold py-4 px-10 rounded-xl shadow-lg hover:bg-indigo-700 transition-all">
                                        Post Project & Get Matches
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            },
            
            /**
             * Renders the Login / Signup page
             */
            renderAuthPage(initialView = 'signup') {
                return `
                    <div class="max-w-5xl mx-auto">
                        <!-- Main View -->
                        <div id="auth-main" class="${initialView === 'form' ? 'hidden' : 'block'}">
                            <div class="text-center mb-16">
                                <h1 class="text-5xl font-bold text-slate-900 mb-4 brand-font">Join <span class="bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">TechieNova</span></h1>
                                <p class="text-xl text-slate-600">Are you looking to hire top talent, or ready to land your next great project?</p>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <!-- I'm a Client -->
                                <div class="bg-gradient-to-br from-white to-slate-50 p-8 rounded-2xl border-2 border-slate-200 hover:border-indigo-600 text-center transition-all shadow-lg hover:shadow-xl">
                                    <div class="w-14 h-14 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6">
                                        <svg class="w-7 h-7 text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M13 7H7v6h6V7z"/><path fill-rule="evenodd" d="M7 2a1 1 0 012 0v1h2V2a1 1 0 112 0v1h2V2a1 1 0 112 0v1h2V2a1 1 0 012 0v1h1a2 2 0 012 2v2h1a1 1 0 110 2h-1v2h1a1 1 0 110 2h-1v2h1a1 1 0 110 2h-1v1a2 2 0 01-2 2h-1v1a1 1 0 11-2 0v-1h-2v1a1 1 0 11-2 0v-1H9v1a1 1 0 11-2 0v-1H5a2 2 0 01-2-2v-1H2a1 1 0 110-2h1V9H2a1 1 0 010-2h1V5H2a1 1 0 010-2h1V2a2 2 0 012-2h1V1a1 1 0 010-2z" clip-rule="evenodd"/></svg>
                                    </div>
                                    <h2 class="text-3xl font-bold text-slate-900 mb-3 brand-font">Hire Top Talent</h2>
                                    <p class="text-slate-600 mb-8 h-20">Find, hire, and manage world-class freelancers and pre-vetted teams to bring your vision to life.</p>
                                    <button data-auth-action="show-form" data-form-type="signup" data-user-type="client" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold py-3 px-8 rounded-lg shadow-lg hover:shadow-xl hover:from-indigo-700 hover:to-purple-700 transition-all duration-300">
                                        Sign Up to Hire
                                    </button>
                                    <p class="mt-6 text-sm text-slate-600">
                                        Already have an account? 
                                        <a href="#" data-auth-action="show-form" data-form-type="login" data-user-type="client" class="font-semibold text-indigo-600 hover:text-indigo-700">Log In</a>
                                    </p>
                                </div>
                                <!-- I'm Talent -->
                                <div class="bg-gradient-to-br from-white to-slate-50 p-8 rounded-2xl border-2 border-slate-200 hover:border-purple-600 text-center transition-all shadow-lg hover:shadow-xl">
                                    <div class="w-14 h-14 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-6">
                                        <svg class="w-7 h-7 text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"/></svg>
                                    </div>
                                    <h2 class="text-3xl font-bold text-slate-900 mb-3 brand-font">Find Quality Work</h2>
                                    <p class="text-slate-600 mb-8 h-20">Discover high-paying projects, build your portfolio, and grow your freelance business with us.</p>
                                    <button data-auth-action="show-form" data-form-type="signup" data-user-type="freelancer" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold py-3 px-8 rounded-lg shadow-lg hover:shadow-xl hover:from-purple-700 hover:to-pink-700 transition-all duration-300">
                                        Apply to Join
                                    </button>
                                    <p class="mt-6 text-sm text-slate-600">
                                        Already have an account? 
                                        <a href="#" data-auth-action="show-form" data-form-type="login" data-user-type="freelancer" class="font-semibold text-purple-600 hover:text-purple-700">Log In</a>
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Form View -->
                        <div id="auth-form-container" class="${initialView === 'form' ? 'block' : 'hidden'} max-w-md mx-auto">
                            <!-- Content injected by showAuthForm() -->
                        </div>
                    </div>
                `;
            },
            
            showAuthForm(formType, userType) {
                document.getElementById('auth-main').classList.add('hidden');
                const container = document.getElementById('auth-form-container');
                container.classList.remove('hidden');
                
                const title = formType === 'login' ? 'Log In' : 'Sign Up';
                const userTypeName = userType === 'client' ? 'Client' : 'Talent';
                const buttonColor = userType === 'client' ? 'bg-indigo-600 hover:bg-indigo-700' : 'bg-slate-800 hover:bg-slate-900';
                
                container.innerHTML = `
                    <h2 class="text-3xl font-bold text-slate-900 text-center mb-2">${title} as ${userTypeName}</h2>
                    <p class="text-center text-slate-600 mb-8">
                        <a href="#" onclick="document.getElementById('auth-main').classList.remove('hidden'); document.getElementById('auth-form-container').classList.add('hidden');" class="font-medium text-indigo-600 hover:underline">&larr; Back to options</a>
                    </p>
                    
                    <!-- UPDATED: Form now has onsubmit handler -->
                    <form class="space-y-6" onsubmit="app.handleAuthFormSubmit(event, '${formType}', '${userType}')">
                        ${formType === 'signup' ? `
                        <div>
                            <label for="name" class="block text-sm font-medium text-slate-700">Full Name</label>
                            <input type="text" id="name" name="name" required class="mt-1 w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                        </div>` : ''}
                        
                        <div>
                            <label for="email" class="block text-sm font-medium text-slate-700">Email Address</label>
                            <input type="email" id="email" name="email" required class="mt-1 w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                        </div>
                        
                        <div>
                            <label for="password" class="block text-sm font-medium text-slate-700">Password</label>
                            <input type="password" id="password" name="password" required class="mt-1 w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                        </div>
                        
                        <!-- NEW: Error display area -->
                        <div id="auth-error" class="text-red-600 text-sm font-medium"></div>
                        
                        <!-- UPDATED: Button is now type="submit" -->
                        <button type="submit" class="w-full ${buttonColor} text-white font-semibold py-3 px-8 rounded-lg shadow-md transition-all">
                            ${title}
                        </button>
                    </form>
                    
                    <!-- Social Login Buttons -->
                    <div class="mt-6">
                        <div class="relative">
                            <div class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-slate-300"></div>
                            </div>
                            <div class="relative flex justify-center text-sm">
                                <span class="px-2 bg-white text-slate-500">Or ${formType} with</span>
                            </div>
                        </div>

                        <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-3">
                            <!-- Google Button (FIXED: Correct SVG) -->
                            <button onclick="app.handleSocialLogin('google'${formType === 'signup' ? `, '${userType}'` : ''})" class="w-full inline-flex justify-center py-3 px-4 border border-slate-300 rounded-lg shadow-sm bg-white text-sm font-medium text-slate-700 hover:bg-slate-50">
                                <span class="sr-only">${formType} with Google</span>
                                <svg class="w-5 h-5" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M19.6 10.23c0-.82-.07-1.6-.2-2.35H10.24v4.44h5.27c-.23 1.44-1 2.65-2.13 3.47v2.85h3.66c2.14-1.97 3.38-4.88 3.38-8.41z" fill="#4285F4"></path>
                                    <path d="M10.24 20c2.9 0 5.34-.96 7.1-2.58l-3.66-2.85c-.96.65-2.18 1.04-3.44 1.04-2.8 0-5.17-1.89-6.02-4.43H.52v2.93C2.26 18.06 5.96 20 10.24 20z" fill="#34A853"></path>
                                    <path d="M4.22 11.95c-.21-.65-.33-1.33-.33-2.03s.12-1.38.33-2.03V4.96H.52C.19 6.27 0 7.68 0 9.18s.19 2.91.52 4.22l3.7-2.92z" fill="#FBBC05"></path>
                                    <path d="M10.24 3.9c1.55 0 2.93.53 4.02 1.58l3.26-3.26C15.58.96 13.14 0 10.24 0 5.96 0 2.26 1.94.52 4.96l3.7 2.92c.85-2.54 3.22-4.43 6.02-4.43z" fill="#EA4335"></path>
                                </svg>
                                <span class="ml-2">Google</span>
                            </button>

                            <!-- GitHub Button -->
                            <button onclick="app.handleSocialLogin('github'${formType === 'signup' ? `, '${userType}'` : ''})" class="w-full inline-flex justify-center py-3 px-4 border border-slate-300 rounded-lg shadow-sm bg-white text-sm font-medium text-slate-700 hover:bg-slate-50">
                                <span class="sr-only">${formType} with GitHub</span>
                                <svg class="w-5 h-5" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 0C4.477 0 0 4.477 0 10c0 4.418 2.865 8.166 6.839 9.49.5.092.682-.217.682-.483 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.155-1.11-1.462-1.11-1.462-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0110 4.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.026 2.747-1.026.546 1.379.202 2.398.1 2.65.64.7 1.028 1.595 1.028 2.688 0 3.85-2.339 4.695-4.566 4.942.359.308.678.92.678 1.85 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.001 10.001 0 0020 10c0-5.523-4.477-10-10-10z" clip-rule="evenodd" />
                                </svg>
                                <span class="ml-2">GitHub</span>
                            </button>
                        </div>
                    </div>
                `;
            },
            
            /**
             * Renders the user Dashboard (Client or Freelancer)
             */
            renderDashboard() {
                const { currentUser } = appState;
                if (!currentUser) {
                    // This is a safeguard, navigateTo should already prevent this
                    return this.renderAuthPage('login');
                }

                if (currentUser.type === 'client') {
                    return this.renderClientDashboard();
                } else {
                    return this.renderFreelancerDashboard();
                }
            },

            renderClientDashboard() {
                return `
                    <h1 class="text-4xl font-bold text-slate-900 mb-8">Client Dashboard</h1>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <!-- Main Content -->
                        <div class="lg:col-span-2 bg-white p-8 rounded-xl shadow-lg">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-2xl font-semibold text-slate-900">My Projects</h2>
                                <button onclick="app.navigateTo('postProject')" class="bg-indigo-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:bg-indigo-700 transition-all">
                                    Post New Project
                                </button>
                            </div>
                            <div class="space-y-4">
                                <!-- Mock Project List -->
                                ${this.renderProjectStatusCard("AI chatbot integration for Shopify store", "In Progress", 1, "Milestone 1/3 Funded")}
                                ${this.renderProjectStatusCard("Rebrand and new logo for a tech startup", "Reviewing Proposals", 3, "4 proposals received")}
                                ${this.renderProjectStatusCard("Monthly blog content", "Completed", 0, "Paid $1,200")}
                            </div>
                        </div>
                        <!-- Sidebar -->
                        <div class="lg:col-span-1 space-y-6">
                            <div class="bg-white p-8 rounded-xl shadow-lg">
                                <h3 class="text-xl font-semibold text-slate-900 mb-4">Messages</h3>
                                <p class="text-slate-600">You have 2 unread messages.</p>
                                <button class="mt-4 w-full bg-slate-100 text-slate-800 font-semibold py-2.5 px-5 rounded-lg hover:bg-slate-200 transition-all">
                                    View Inbox
                                </button>
                            </div>
                            <div class="bg-white p-8 rounded-xl shadow-lg">
                                <h3 class="text-xl font-semibold text-slate-900 mb-4">Account</h3>
                                <p class="text-slate-600">Manage billing and settings.</p>
                                <button class="mt-4 w-full bg-slate-100 text-slate-800 font-semibold py-2.5 px-5 rounded-lg hover:bg-slate-200 transition-all">
                                    Settings
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            },
            
            renderProjectStatusCard(title, status, messages, statusDetail = null) {
                const statusColor = status === 'In Progress' ? 'text-blue-600 bg-blue-100' : (status === 'Reviewing Proposals' ? 'text-yellow-600 bg-yellow-100' : 'text-green-600 bg-green-100');
                return `
                    <div class="border border-slate-200 p-4 rounded-lg flex justify-between items-center">
                        <div>
                            <h4 class="text-lg font-semibold text-slate-800">${title}</h4>
                            <span class="text-sm font-medium px-2.5 py-0.5 rounded-full ${statusColor}">${status}</span>
                            ${statusDetail ? `<span class="text-sm text-slate-500 ml-2">${statusDetail}</span>` : ''}
                        </div>
                        <div class="flex items-center space-x-4">
                            ${messages > 0 ? `<span class="text-sm font-bold text-indigo-600">${messages} new</span>` : ''}
                            <button class="text-indigo-600 font-medium hover:underline">Manage</button>
                        </div>
                    </div>
                `;
            },

            renderFreelancerDashboard() {
                return `
                    <h1 class="text-4xl font-bold text-slate-900 mb-8">Freelancer Dashboard</h1>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <!-- Main Content -->
                        <div class="lg:col-span-2 bg-white p-8 rounded-xl shadow-lg">
                            <h2 class="text-2xl font-semibold text-slate-900 mb-6">My Active Gigs</h2>
                            <div class="space-y-4">
                                <!-- Mock Gig List -->
                                ${this.renderProjectStatusCard("AI chatbot integration for Shopify store", "In Progress", 1, "Milestone 1/3 Due")}
                                ${this.renderProjectStatusCard("Modern website for new coffee shop", "Awaiting Client Review", 0, "Milestone 2 Submitted")}
                            </div>
                            
                            <h2 class="text-2xl font-semibold text-slate-900 mt-12 mb-6">My Proposals</h2>
                             <div class="space-y-4">
                                ${this.renderProjectStatusCard("Rebrand and new logo for a tech startup", "Submitted", 0, "Viewed by client")}
                            </div>
                        </div>
                        <!-- Sidebar -->
                        <div class="lg:col-span-1 space-y-6">
                            <div class="bg-indigo-600 text-white p-8 rounded-xl shadow-lg">
                                <h3 class="text-xl font-semibold mb-2">Available to Withdraw</h3>
                                <p class="text-4xl font-bold">$4,200.00</p>
                                <button class="mt-6 w-full bg-white text-indigo-700 font-semibold py-2.5 px-5 rounded-lg shadow-md hover:bg-indigo-50 transition-all">
                                    Withdraw Funds
                                </button>
                            </div>
                            <div class="bg-white p-8 rounded-xl shadow-lg">
                                <h3 class="text-xl font-semibold text-slate-900 mb-4">Messages</h3>
                                <p class="text-slate-600">You have 1 unread message.</p>
                                <button class="mt-4 w-full bg-slate-100 text-slate-800 font-semibold py-2.5 px-5 rounded-lg hover:bg-slate-200 transition-all">
                                    View Inbox
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            },

            /**
             * NEW: Renders the Freelancer Profile Page
             */
            renderFreelancerProfile(id) {
                const freelancer = mockDatabase.freelancers.find(f => f.id == id);
                if (!freelancer) {
                    return `<p>Error: Freelancer not found.</p>`;
                }

                return `
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <!-- Left Column: Main Content -->
                        <div class="lg:col-span-2 space-y-8">
                            <!-- Header Card -->
                            <div class="bg-white p-8 rounded-xl shadow-lg">
                                <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-6 sm:space-y-0 sm:space-x-6">
                                    <img src="${freelancer.avatarUrl}" alt="${freelancer.name}" class="w-32 h-32 rounded-full border-4 border-white shadow-lg flex-shrink-0">
                                    <div class="flex-grow">
                                        <h1 class="text-3xl font-bold text-slate-900 flex items-center">
                                            ${freelancer.name}
                                            ${freelancer.verified ? `
                                                <svg class="w-7 h-7 text-green-500 ml-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                                                </svg>
                                            ` : ''}
                                        </h1>
                                        <p class="text-xl text-slate-600 mt-1">${freelancer.title}</p>
                                        ${freelancer.isTeam ? `<span class="inline-block bg-indigo-100 text-indigo-800 text-xs font-bold px-3 py-1 rounded-full mt-2 uppercase tracking-wider">Pre-Vetted Team</span>` : ''}
                                    </div>
                                    <button class="w-full sm:w-auto bg-indigo-600 text-white font-semibold py-3 px-8 rounded-lg shadow-md hover:bg-indigo-700 transition-all flex-shrink-0">
                                        Hire Now
                                    </button>
                                </div>
                            </div>

                            <!-- Bio Card -->
                            <div class="bg-white p-8 rounded-xl shadow-lg">
                                <h2 class="text-2xl font-semibold text-slate-900 mb-4">About ${freelancer.name}</h2>
                                <p class="text-slate-700 text-base leading-relaxed whitespace-pre-line">${freelancer.bio}</p>
                            </div>
                            
                            <!-- Portfolio Card -->
                            <div class="bg-white p-8 rounded-xl shadow-lg">
                                <h2 class="text-2xl font-semibold text-slate-900 mb-6">Portfolio</h2>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    ${freelancer.portfolio.length > 0 ? freelancer.portfolio.map(item => `
                                        <div class="rounded-lg overflow-hidden border border-slate-200">
                                            <img src="${item.img}" alt="${item.title}" class="w-full h-48 object-cover">
                                            <p class="p-4 font-medium text-slate-800">${item.title}</p>
                                        </div>
                                    `).join('') : '<p class="text-slate-600">No portfolio items added yet.</p>'}
                                </div>
                            </div>
                            
                            <!-- Reviews Card -->
                            <div class="bg-white p-8 rounded-xl shadow-lg">
                                <h2 class="text-2xl font-semibold text-slate-900 mb-6">Client Reviews (${freelancer.reviews.length})</h2>
                                <div class="space-y-6">
                                    ${freelancer.reviews.length > 0 ? freelancer.reviews.map(review => `
                                        <div class="border-b border-slate-100 pb-6 last:border-b-0">
                                            <div class="flex items-center mb-2">
                                                <div class="flex items-center">
                                                    ${[...Array(review.rating)].map(() => `<svg class="w-5 h-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10.868 2.884c.321-.662 1.134-.662 1.456 0l1.833 3.791c.16.33.461.558.82.606l4.179.607c.725.105 1.018.99 1.411.543-.3 1.06-.411-1.096-.543-1.411l-4.179-.607a1.125 1.125 0 01-.82-.606L10.868 2.884zM10 12.585l-3.418 1.797a.75.75 0 01-1.088-1.01l.653-3.805a.75.75 0 00-.216-.664l-2.768-2.697a.75.75 0 01.416-1.28l3.82-.555a.75.75 0 00.56-.41L9.13 2.11a.75.75 0 011.34 0l1.71 3.47a.75.75 0 00.56.41l3.82.555a.75.75 0 01.416 1.28l-2.768 2.697a.75.75 0 00-.216.664l.653 3.805a.75.75 0 01-1.088 1.01L10 12.585z" clip-rule="evenodd" /></svg>`).join('')}
                                                </div>
                                                <span class="ml-2 font-bold text-slate-800">${review.name}</span>
                                            </div>
                                            <p class="text-slate-700">"${review.text}"</p>
                                        </div>
                                    `).join('') : '<p class="text-slate-600">No reviews yet.</p>'}
                                </div>
                            </div>
                        </div>

                        <!-- Right Column: Stats & Skills -->
                        <div class="lg:col-span-1 space-y-6">
                            <!-- Stats Card -->
                            <div class="bg-white p-8 rounded-xl shadow-lg">
                                <div class="flex justify-between items-center mb-4">
                                    <span class="text-4xl font-bold text-slate-900">$${freelancer.rate}</span>
                                    <span class="text-slate-600 text-lg">/hr</span>
                                </div>
                                <div class="space-y-4">
                                    <div class="flex justify-between items-center text-lg">
                                        <span class="text-slate-600">Rating</span>
                                        <span class="font-bold text-slate-900 flex items-center">
                                            <svg class="w-5 h-5 text-yellow-400 mr-1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10.868 2.884c.321-.662 1.134-.662 1.456 0l1.833 3.791c.16.33.461.558.82.606l4.179.607c.725.105 1.018.99 1.411.543-.3 1.06-.411-1.096-.543-1.411l-4.179-.607a1.125 1.125 0 01-.82-.606L10.868 2.884zM10 12.585l-3.418 1.797a.75.75 0 01-1.088-1.01l.653-3.805a.75.75 0 00-.216-.664l-2.768-2.697a.75.75 0 01.416-1.28l3.82-.555a.75.75 0 00.56-.41L9.13 2.11a.75.75 0 011.34 0l1.71 3.47a.75.75 0 00.56.41l3.82.555a.75.75 0 01.416 1.28l-2.768 2.697a.75.75 0 00-.216.664l.653 3.805a.75.75 0 01-1.088 1.01L10 12.585z" clip-rule="evenodd" /></svg>
                                            ${freelancer.rating}
                                        </span>
                                    </div>
                                    <div class="flex justify-between items-center text-lg">
                                        <span class="text-slate-600">Jobs Completed</span>
                                        <span class="font-bold text-slate-900">${freelancer.jobs}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Skills Card -->
                            <div class="bg-white p-8 rounded-xl shadow-lg">
                                <h3 class="text-xl font-semibold text-slate-900 mb-4">Top Skills</h3>
                                <div class="flex flex-wrap gap-2">
                                    ${freelancer.skills.map(skill => `<span class="inline-block bg-slate-100 text-slate-700 text-sm font-medium px-3 py-1 rounded-full">${skill}</span>`).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            },
            
            /**
             * NEW: Renders the Project Detail Page
             */
            renderProjectDetail(id) {
                const project = mockDatabase.projects.find(p => p.id == id);
                if (!project) {
                    return `<p>Error: Project not found.</p>`;
                }

                return `
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <!-- Left Column: Project Details -->
                        <div class="lg:col-span-2 bg-white p-8 rounded-xl shadow-lg">
                            <h1 class="text-4xl font-bold text-slate-900 mb-4">${project.title}</h1>
                            <span class="text-sm text-slate-500">Posted ${project.posted}</span>
                            
                            <hr class="my-6 border-slate-100">
                            
                            <h2 class="text-2xl font-semibold text-slate-900 mb-4">Project Description</h2>
                            <p class="text-slate-700 text-base leading-relaxed whitespace-pre-line">${project.description}</p>
                            
                            <h3 class="text-2xl font-semibold text-slate-900 mt-8 mb-4">Skills Required</h3>
                            <div class="flex flex-wrap gap-2">
                                ${project.skills.map(skill => `<span class="inline-block bg-slate-100 text-slate-700 text-sm font-medium px-3 py-1 rounded-full">${skill}</span>`).join('')}
                            </div>
                        </div>

                        <!-- Right Column: Apply & Client Info -->
                        <div class="lg:col-span-1 space-y-6">
                            <!-- Apply Card -->
                            <div class="bg-white p-8 rounded-xl shadow-lg">
                                <h3 class="text-xl font-semibold text-slate-900 mb-4">Apply for this Project</h3>
                                <div class="mb-4">
                                    <span class="block text-slate-600">Project Budget</span>
                                    <span class="text-3xl font-bold text-slate-900">$${project.budget.toLocaleString()}</span>
                                </div>
                                <textarea rows="5" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none text-base mb-4" placeholder="Write your proposal..."></textarea>
                                <button class="w-full bg-indigo-600 text-white font-semibold py-3 px-8 rounded-lg shadow-md hover:bg-indigo-700 transition-all">
                                    Send Proposal
                                </button>
                            </div>
                            
                            <!-- Client Info Card -->
                            <div class="bg-white p-8 rounded-xl shadow-lg">
                                <h3 class="text-xl font-semibold text-slate-900 mb-4">About the Client</h3>
                                <p class="text-lg font-semibold text-slate-800">${project.client.name}</p>
                                <div class="flex items-center space-x-1 mt-1">
                                    <svg class="w-5 h-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10.868 2.884c.321-.662 1.134-.662 1.456 0l1.833 3.791c.16.33.461.558.82.606l4.179.607c.725.105 1.018.99 1.411.543-.3 1.06-.411-1.096-.543-1.411l-4.179-.607a1.125 1.125 0 01-.82-.606L10.868 2.884zM10 12.585l-3.418 1.797a.75.75 0 01-1.088-1.01l.653-3.805a.75.75 0 00-.216-.664l-2.768-2.697a.75.75 0 01.416-1.28l3.82-.555a.75.75 0 00.56-.41L9.13 2.11a.75.75 0 011.34 0l1.71 3.47a.75.75 0 00.56.41l3.82.555a.75.75 0 01.416 1.28l-2.768 2.697a.75.75 0 00-.216.664l.653 3.805a.75.75 0 01-1.088 1.01L10 12.585z" clip-rule="evenodd" /></svg>
                                    <span class="text-lg font-bold text-slate-700">${project.client.rating}</span>
                                </div>
                                <p class="text-base text-slate-600 mt-2">${project.client.history}</p>
                            </div>
                        </div>
                    </div>
                `;
            },
            
            // --- LOGIC HANDLERS ---
            
            /**
             * Simulates AI analysis of the project brief
             */
            handleAiBrief() {
                const brief = document.getElementById('ai-brief').value;
                if (brief.trim().length < 10) {
                    // Use the non-alert error method
                    this.showError("Please describe your project in more detail.");
                    return;
                }
                
                const resultsContainer = document.getElementById('ai-results');
                const loadingDiv = document.getElementById('ai-loading');
                const formDiv = document.getElementById('ai-form');
                
                resultsContainer.classList.remove('hidden');
                loadingDiv.classList.remove('hidden');
                formDiv.classList.add('hidden');
                
                // Simulate AI processing
                setTimeout(() => {
                    // Simple keyword-based simulation
                    let title = "Project based on your brief";
                    let skills = "General,";
                    let budget = "$1,000 - $3,000";
                    
                    if (brief.toLowerCase().includes("website") || brief.toLowerCase().includes("webflow")) {
                        title = "New Website Project";
                        skills = "Web Design, Webflow, React, HTML/CSS";
                        budget = "$2,500 - $6,000";
                    }
                    if (brief.toLowerCase().includes("logo") || brief.toLowerCase().includes("brand")) {
                        title = "Branding & Logo Design";
                        skills = "Logo Design, Branding, Graphic Design";
                        budget = "$3,000 - $8,000";
                    }
                    if (brief.toLowerCase().includes("ai") || brief.toLowerCase().includes("chatbot")) {
                        title = "AI Integration Project";
                        skills = "AI Integration, Python, APIs, Chatbot";
                        budget = "$1,500 - $5,000";
                    }

                    // Populate form
                    document.getElementById('project-title').value = title;
                    document.getElementById('project-skills').value = skills;
                    document.getElementById('project-budget').value = budget;
                    
                    // Show results
                    loadingDiv.classList.add('hidden');
                    formDiv.classList.remove('hidden');
                    
                }, 1500);
            }
        };

        // Initialize the app on load
        document.addEventListener('DOMContentLoaded', () => {
            // Expose app to global scope for onclick handlers
            window.app = app;
            app.init();
        });
    </script>

</body>
</html>

